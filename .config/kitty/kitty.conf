#############################################################################
# Color scheme
#############################################################################

# include                 colors/nord.conf
# include                 colors/gruvbox_dark.conf
# include                 colors/catpuccin.conf
include                 colors/rose-pine.conf

background_opacity      1
background_image        none
# background_image        ${HOME}/.config/wallpapers/anime-1.png
# background_image        ${HOME}/.config/wallpapers/lofi-1.png
# background_image        ${HOME}/.config/wallpapers/city-1.png
background_image        ${HOME}/.config/wallpapers/anime-1.png
background_tint         0.90
background_image_layout cscaled

dim_opacity             0

#############################################################################
# Cursor customization
#############################################################################

cursor #ff8758
cursor_text_color #444
cursor_shape beam 
cursor_beam_thickness 2.0
cursor_underline_thickness 2.0
cursor_blink_interval -1
cursor_stop_blinking_after 15

#############################################################################
# Fonts management
#############################################################################

include             ${KITTY_OS}.conf

font_family         FiraCodeNerdFont-Regular
bold_font           FiraCodeNerdFont-SemiBold

adjust_line_height  5

#############################################################################
# Window layout
#############################################################################

# window_padding_width      0
window_padding_width        5.0 5.0
placement_strategy          top-left
inactive_text_alpha         0.8
hide_window_decorations     no

#############################################################################
# Tab bar
#############################################################################

# Tab bar options
tab_bar_edge               bottom
# tab_bar_margin_width       5.0
tab_bar_margin_width       0.0
# tab_bar_margin_height      7.5 7.5
tab_bar_margin_height      0.0 0.0
tab_bar_style              custom
tab_bar_align              left
tab_bar_min_tabs           1
# tab_title_template         "󰨸 {index}: {title[title.rfind('/')+1:]}"
# tab_title_template "{f'{title[:30]}…' if title.rindex(title[-1]) + 1 > 30 else (title.center(6) if (title.rindex(title[-1]) + 1) % 2 == 0 else title.center(5))}"
tab_title_template         "{title[title.rfind('/')+1:]}"
active_tab_font_style      bold
tab_activity_symbol        none
bell_on_tab                no
tab_separator              ""

active_border_color          #303030
# Tab bar colors
# tab_bar_background         #303030
# tab_bar_margin_color       #303030
# active_tab_foreground      #ffffff
# inactive_tab_foreground    #ffffff
# active_tab_background      #454545
# inactive_tab_background    #303030

# Search
map super+f                    launch --type=overlay --stdin-source=@screen_scrollback /opt/homebrew/bin/fzf --no-sort --no-mouse --exact -i
map ctrl+f                     launch --type=overlay --stdin-source=@screen_scrollback /opt/homebrew/bin/fzf --no-sort --no-mouse --exact -i

#############################################################################
# OS specific tweaks
#############################################################################

wayland_titlebar_color                  system
macos_titlebar_color                    system
macos_option_as_alt                     yes # Allow option to work as alt on macos
macos_thicken_font                      0.4
macos_show_window_title_in              none
macos_quit_when_last_window_closed      yes
macos_window_resizable                  yes

#############################################################################
# Terminal
#############################################################################

enable_audio_bell           no
allow_hyperlinks            yes

# Configure vim-kitty-navigator
allow_remote_control        yes
listen_on                   unix:/tmp/mykitty

# Enabled layouts
enabled_layouts splits:split_axis=vertical,stack

#############################################################################
# Keyboard shortcuts
#############################################################################

# Vim/kitty-navigation
map ctrl+j kitten pass_keys.py neighboring_window bottom ctrl+j "vim"
map ctrl+k kitten pass_keys.py neighboring_window top    ctrl+k "vim"  
map ctrl+h kitten pass_keys.py neighboring_window left   ctrl+h "vim"
map ctrl+l kitten pass_keys.py neighboring_window right  ctrl+l "vim"

# Close window
map cmd+backspace close_window_with_confirmation ignore-shell

# Splits
map cmd+/ launch --location=vsplit --cwd=current
map cmd+enter new_window_with_cwd

# Move window
map shift+up move_window up
map shift+left move_window left
map shift+right move_window right
map shift+down move_window down

# Resize window
map cmd+up resize_window taller 2
map cmd+down resize_window shorter 2
map cmd+right resize_window wider 2
map cmd+left resize_window narrower 2
map cmd+0 resize_window reset

# Font sizes
map cmd+equal               change_font_size all 0
map cmd+plus                change_font_size all +1.0
map cmd+kp_add              change_font_size all +1.0
map cmd+minus               change_font_size all -1.0
map cmd+kp_subtract         change_font_size all -1.0

# Tab management
map super+t              new_tab_with_cwd
map super+n              new_tab
map super+1              goto_tab 1
map super+2              goto_tab 2
map super+3              goto_tab 3
map super+4              goto_tab 4
map super+5              goto_tab 5
map super+6              goto_tab 6
map super+7              goto_tab 7
map super+8              goto_tab 8
map super+9              goto_tab 9

# Configure the scrollback_pager to use neovim
scrollback_pager zsh -c "nvim -c 'let g:is_kitty_scrollback=1' -c 'silent write! /tmp/kitty_scrollback_buffer | te cat /tmp/kitty_scrollback_buffer - '"

# ======
